# üöõ –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Å—Ç–∏–∫–∏ –•—Ä—É—Å—Ç–∞–ª—å

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–º–µ–Ω—ã –º–∞—Ä—à—Ä—É—Ç–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤ —Å –∞–≤—Ç–æ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º –∑–∞–∫–∞–∑–æ–≤ –ø–æ —Ä–∞–π–æ–Ω–∞–º.

## üéØ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### –î–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π
- –ü–∞–Ω–µ–ª—å —Å –∑–∞–∫–∞–∑–∞–º–∏ –Ω–∞ –¥–µ–Ω—å
- –ö–Ω–æ–ø–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥

### –î–ª—è –ª–æ–≥–∏—Å—Ç–æ–≤
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- –†—É—á–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –≤–æ–¥–∏—Ç–µ–ª—è–º
- –°—Ç–∞—Ç—É—Å –≤–æ–¥–∏—Ç–µ–ª–µ–π (–æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∑–∞–∫–∞–∑–∞–º

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –º–∞—à–∏–Ω –ø–æ —Ä–∞–π–æ–Ω–∞–º
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (overrides)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –º–∞—à–∏–Ω –∏ –∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Next.js 15** (App Router)
- **Prisma ORM** —Å PostgreSQL
- **Tailwind CSS** –¥–ª—è —Å—Ç–∏–ª–µ–π
- **Browser Notifications API** –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üì¶ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

```prisma
Order - –∑–∞–∫–∞–∑—ã –∏–∑ CRM
Driver - –≤–æ–¥–∏—Ç–µ–ª–∏ 
Vehicle - –º–∞—à–∏–Ω—ã
RegionOverride - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–π–æ–Ω–æ–≤
```

## üó∫Ô∏è –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ

- **–¶–µ–Ω—Ç—Ä** ‚Üí –ú–∞—à–∏–Ω–∞ 1
- **–í–æ–∫–∑–∞–ª** ‚Üí –ú–∞—à–∏–Ω–∞ 2
- **–¶–µ–Ω—Ç—Ä –ü–ó** ‚Üí –ú–∞—à–∏–Ω–∞ 3
- **–í–æ–∫–∑–∞–ª –ü–ó** ‚Üí –ú–∞—à–∏–Ω–∞ 4
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è** ‚Üí –ú–∞—à–∏–Ω–∞ 5
- **–ò–Ω—ã–µ —Ä–∞–π–æ–Ω—ã** ‚Üí –ú–∞—à–∏–Ω–∞ 6

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª
DATABASE_URL="postgresql://user:password@localhost:5432/hrustal"
JWT_SECRET="your-secret-key"

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
npm run db:push
npm run db:generate
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
npm run seed
```

–°–æ–∑–¥–∞—Å—Ç:
- 6 –≤–æ–¥–∏—Ç–µ–ª–µ–π (driver1-driver6, PIN: 1111-6666)
- 6 –º–∞—à–∏–Ω
- 6 —Ä–∞–π–æ–Ω–æ–≤
- 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- 1 —Ç–µ—Å—Ç–æ–≤—ã–π override

### 4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
npm run dev
```

## üì± –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### `/driver/[id]` - –ü–∞–Ω–µ–ª—å –≤–æ–¥–∏—Ç–µ–ª—è
- –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –¥–µ–Ω—å
- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞–º–∏
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–∞—Ö –∏ –∫–ª–∏–µ–Ω—Ç–∞—Ö
- Timeline –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞

### `/logistics/dashboard` - –ü–∞–Ω–µ–ª—å –ª–æ–≥–∏—Å—Ç–∞
- –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –≤–æ–¥–∏—Ç–µ–ª–µ–π
- –°—Ç–∞—Ç—É—Å –≤–æ–¥–∏—Ç–µ–ª–µ–π

### `/admin/machines` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—à–∏–Ω–∞–º–∏
- –¢–µ–∫—É—â–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
- –°–æ–∑–¥–∞–Ω–∏–µ overrides
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –º–∞—à–∏–Ω

## üîå API Endpoints

### Webhook –¥–ª—è CRM
```
POST /api/webhook/crm
{
  "external_id": "CRM-123",
  "customer_name": "–û–û–û –ö–æ–º–ø–∞–Ω–∏—è",
  "customer_phone": "+7-900-123-45-67",
  "customer_address": "—É–ª. –õ–µ–Ω–∏–Ω–∞, 10",
  "region": "–¶–µ–Ω—Ç—Ä",
  "products": { "items": [...] },
  "total_amount": 5000,
  "delivery_date": "2025-01-15",
  "delivery_time": "10:00-12:00"
}
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏
```
GET /api/orders?date=2025-01-15&status=new
PUT /api/orders
POST /api/orders/assign
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ overrides
```
GET /api/overrides?date=2025-01-15
POST /api/overrides
DELETE /api/overrides
```

## üîÑ –ê–≤—Ç–æ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

1. –ó–∞–∫–∞–∑ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑ CRM —á–µ—Ä–µ–∑ webhook
2. –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–π–æ–Ω –¥–æ—Å—Ç–∞–≤–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç override –Ω–∞ –¥–∞—Ç—É –¥–æ—Å—Ç–∞–≤–∫–∏
4. –ï—Å–ª–∏ –Ω–µ—Ç override - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ
5. –ù–∞–∑–Ω–∞—á–∞–µ—Ç –≤–æ–¥–∏—Ç–µ–ª—è –∏ –º–∞—à–∏–Ω—É
6. –í–æ–¥–∏—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

## üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

- –†–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ Browser Notifications API
- –í–æ–¥–∏—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- –ù–µ —Ç—Ä–µ–±—É—é—Ç WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤

- `new` - –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑
- `assigned` - –Ω–∞–∑–Ω–∞—á–µ–Ω –≤–æ–¥–∏—Ç–µ–ª—é
- `accepted` - –ø—Ä–∏–Ω—è—Ç –≤–æ–¥–∏—Ç–µ–ª–µ–º
- `in_progress` - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏
- `completed` - –¥–æ—Å—Ç–∞–≤–ª–µ–Ω
- `cancelled` - –æ—Ç–º–µ–Ω—ë–Ω

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
src/
  app/
    api/           # API endpoints
    driver/[id]/   # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–æ–¥–∏—Ç–µ–ª—è
    logistics/     # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ª–æ–≥–∏—Å—Ç–∞
    admin/         # –ê–¥–º–∏–Ω–∫–∞
  components/      # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
prisma/
  schema.prisma    # –°—Ö–µ–º–∞ –ë–î
  seed.ts          # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
```

### –ö–æ–º–∞–Ω–¥—ã
```bash
npm run dev        # –ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ
npm run build      # –°–±–æ—Ä–∫–∞ –¥–ª—è production
npm run seed       # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
npm run db:push    # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –∫ –ë–î
```

## üö® –í–∞–∂–Ω–æ

- –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ WebSocket –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç HTTPS –≤ production
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ.
