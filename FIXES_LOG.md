# üîß –ñ—É—Ä–Ω–∞–ª –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## üìÖ 15 —è–Ω–≤–∞—Ä—è 2025

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

#### 1. BigInt —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ API
**–ü—Ä–æ–±–ª–µ–º–∞:** `TypeError: Do not know how to serialize a BigInt`
- ‚ùå `GET /api/drivers` - –≤–æ–∑–≤—Ä–∞—â–∞–ª BigInt ID –±–µ–∑ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚ùå `POST /api/drivers` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–æ–¥–∏—Ç–µ–ª—è —Å BigInt ID  
- ‚ùå `PUT /api/drivers` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ–¥–∏—Ç–µ–ª—è —Å BigInt ID
- ‚ùå `GET /api/couriers` - –≤–æ–∑–≤—Ä–∞—â–∞–ª BigInt ID –±–µ–∑ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚ùå `POST /api/couriers` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫—É—Ä—å–µ—Ä–∞ —Å BigInt ID
- ‚ùå `PUT /api/couriers` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—å–µ—Ä–∞ —Å BigInt ID

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è BigInt –≤ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –≤—Å–µ—Ö API –º–µ—Ç–æ–¥–æ–≤
```javascript
const serializedData = {
  ...data,
  id: data.id.toString(),
  // ... –¥—Ä—É–≥–∏–µ BigInt –ø–æ–ª—è
};
```

#### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π JWT —Å–µ–∫—Ä–µ—Ç –≤ API –≤–æ–¥–∏—Ç–µ–ª–µ–π
**–ü—Ä–æ–±–ª–µ–º–∞:** `GET /api/driver-leads 401 (Unauthorized)`
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `JWT_SECRET` –≤–º–µ—Å—Ç–æ `DRIVER_JWT_SECRET`

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å–µ–∫—Ä–µ—Ç –≤ `driver-leads/route.ts`
```javascript
const JWT_SECRET = process.env.DRIVER_JWT_SECRET || 'driver-secret-key-2025';
```

#### 3. –û—à–∏–±–∫–∏ SSE –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞  
**–ü—Ä–æ–±–ª–µ–º–∞:** `TypeError: Invalid state: Controller is already closed`
- ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ `controller.desiredSize !== null` –±—ã–ª–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π

**–†–µ—à–µ–Ω–∏–µ:** –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
```javascript
if (controller.desiredSize !== null && controller.desiredSize > 0) {
  controller.enqueue(encoder.encode(pingMessage));
}
```

#### 4. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–∫–æ–Ω–∫–∏ PWA
**–ü—Ä–æ–±–ª–µ–º–∞:** `Download error or resource isn't a valid image`
- ‚ùå –§–∞–π–ª—ã `icon-192x192.png` –∏ `icon-512x512.png` –±—ã–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω—ã SVG –∏–∫–æ–Ω–∫–∏
- ‚úÖ `/icon-192x192.svg` - —Å–∏–Ω—è—è –∏–∫–æ–Ω–∫–∞ —Å —Å–∏–º–≤–æ–ª–æ–º "H"
- ‚úÖ `/icon-512x512.svg` - –±–æ–ª—å—à–∞—è –≤–µ—Ä—Å–∏—è –∏–∫–æ–Ω–∫–∏
- ‚úÖ `/favicon.svg` - –º–∞–ª–µ–Ω—å–∫–∞—è –∏–∫–æ–Ω–∫–∞ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `manifest.json` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SVG

#### 5. –ú–∏–≥—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π –Ω–∞ –ø–∏–Ω-–∫–æ–¥—ã
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
- ‚ùå –ü–æ–ª—è `password` –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `drivers` –∏ `couriers`
- ‚ùå –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ bcrypt –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø–∏–Ω-–∫–æ–¥–æ–≤

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –Ω–∞ –ø–∏–Ω-–∫–æ–¥—ã
- ‚úÖ `password` ‚Üí `pin_code` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è 4-6 —Ü–∏—Ñ—Ä –≤ API –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö
- ‚úÖ –£–±—Ä–∞–Ω–æ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–∏–Ω-–∫–æ–¥—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–æ)
- ‚úÖ –î–µ—Ñ–æ–ª—Ç–Ω—ã–π –ø–∏–Ω-–∫–æ–¥ `1234` –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

#### API
- `src/app/api/drivers/route.ts` - BigInt —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è (GET, POST, PUT)
- `src/app/api/couriers/route.ts` - BigInt —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è (GET, POST, PUT) 
- `src/app/api/driver-leads/route.ts` - JWT —Å–µ–∫—Ä–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- `src/app/api/driver-auth/route.ts` - –ø–∏–Ω-–∫–æ–¥—ã –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
- `src/app/api/courier-auth/route.ts` - –ø–∏–Ω-–∫–æ–¥—ã –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π
- `src/app/api/websocket/route.ts` - —É–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ SSE –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `prisma/schema.prisma` - `password` ‚Üí `pin_code` 
- `prisma/migrations/20250115000003_change_passwords_to_pin_codes/` - –º–∏–≥—Ä–∞—Ü–∏—è

#### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- `src/app/drivers/page.tsx` - –ø–æ–ª—è –ø–∏–Ω-–∫–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫–µ
- `src/app/couriers/page.tsx` - –ø–æ–ª—è –ø–∏–Ω-–∫–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫–µ
- `src/app/driver-work/page.tsx` - –ø–∏–Ω-–∫–æ–¥ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –≤–æ–¥–∏—Ç–µ–ª—è
- `src/app/courier-work/page.tsx` - –ø–∏–Ω-–∫–æ–¥ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∫—É—Ä—å–µ—Ä–∞

#### PWA
- `public/manifest.json` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∫–æ–Ω–∫–∏ –Ω–∞ SVG
- `public/icon-192x192.svg` - –Ω–æ–≤–∞—è –∏–∫–æ–Ω–∫–∞ 192x192
- `public/icon-512x512.svg` - –Ω–æ–≤–∞—è –∏–∫–æ–Ω–∫–∞ 512x512
- `public/favicon.svg` - –Ω–æ–≤—ã–π —Ñ–∞–≤–∏–∫–æ–Ω

### üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

**–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã:**
- ‚úÖ API –≤–æ–¥–∏—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫ BigInt
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤–æ–¥–∏—Ç–µ–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º JWT —Å–µ–∫—Ä–µ—Ç–æ–º
- ‚úÖ SSE —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω—ã –±–µ–∑ –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
- ‚úÖ PWA –∏–∫–æ–Ω–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–∏–Ω-–∫–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤–æ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞:**
- üîê **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –ª–æ–≥–∏–Ω + –ø–∏–Ω-–∫–æ–¥ (4-6 —Ü–∏—Ñ—Ä)
- üìä **API:** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è  
- üîÑ **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∏–Ω-–∫–æ–¥–æ–≤ –≤ PUT –º–µ—Ç–æ–¥–∞—Ö
- üì° **Real-time:** —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ SSE —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- üì± **PWA:** —Ä–∞–±–æ—á–∏–µ –∏–∫–æ–Ω–∫–∏ –∏ manifest

### üîë –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ

**–î–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- **–õ–æ–≥–∏–Ω:** –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ª–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ü–∏–Ω-–∫–æ–¥:** `1234` (–¥–µ—Ñ–æ–ª—Ç–Ω—ã–π, —Ç—Ä–µ–±—É–µ—Ç —Å–º–µ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º)

**–†–∞–±–æ—á–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:**
- üöó **–í–æ–¥–∏—Ç–µ–ª–∏:** `/driver-work` - –ø—Ä–∏–Ω—è—Ç–∏–µ –∏ –¥–æ—Å—Ç–∞–≤–∫–∞ –∑–∞—è–≤–æ–∫
- üë§ **–ö—É—Ä—å–µ—Ä—ã:** `/courier-work` - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á
- ‚öôÔ∏è **–ê–¥–º–∏–Ω—ã:** `/` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ